%
%#min 2x1 + 3x2 + x3
%#st  3x1 + 2x2 + 4x3 = 9
%#all x>0
format long

A = [3 2 4]
v = [5 5 5]
o = ones(3,1)
V = diag(v)
X = diag(o)

mu = 5
%mu_new_new = mu * (1-(.35/sqrt(3)))
mu_new = mu / 3

V_inv = inv(V)

dw = inv(A*V_inv*X*A')*A*V_inv*(V*X*o - mu_new * o)
%dw =  1.03448275862069
dv = -A'*dw
%dv =
%
%  -3.10344827586207
%  -2.06896551724138
%  -4.13793103448276
dx = V_inv * ( mu_new * o - V*X*o - X*dv)
%dx =
%
%  -0.0459770114942529
%  -0.2528735632183908
%   0.1609195402298850
x_new = o + dx
%x_new =
%
%   0.954022988505747
%   0.747126436781609
%   1.160919540229885
w_new = -1 + dw
%w_new =  0.0344827586206895
v_new = v + dv'

%
%r = roots([24 1022 -2179 549])
%
%r= [-1 -1 -1]
%
%
%x = [ mu_new/(2-3*r(1));
%      mu_new/(3-2*r(1));
%      mu_new/(1-4*r(1))]
%
%y = [ 5/(3*(2-3*r(1)));
%      5/(3*(3-2*r(1)));
%      5/(3*(1-4*r(1)))]

c = [2 3 1]
w_new * A + (mu_new ./ x_new)'